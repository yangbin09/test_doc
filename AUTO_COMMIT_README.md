# 自动Git提交脚本使用说明

这个脚本可以帮助你自动化Git提交流程，包括处理冲突和推送到远程仓库。

## 文件说明

- `auto_commit.py` - 主要的Python脚本，包含所有逻辑
- `commit.ps1` - PowerShell包装脚本，方便在Windows下使用
- `AUTO_COMMIT_README.md` - 本说明文档

## 功能特性

✅ **自动检查Git状态** - 检查是否有需要提交的更改  
✅ **拉取最新代码** - 自动从远程仓库拉取最新代码  
✅ **冲突检测** - 检测合并冲突并提示手动解决  
✅ **自动添加文件** - 添加所有更改到暂存区  
✅ **智能提交** - 使用自定义或默认提交信息  
✅ **自动推送** - 推送到远程仓库，处理推送冲突  
✅ **错误处理** - 完善的错误处理和用户友好的提示  

## 使用方法

### 方法1：使用PowerShell脚本（推荐）

```powershell
# 使用自定义提交信息 (可在任何目录执行)
powershell -ExecutionPolicy Bypass -File "D:\code\tera\docs\commit.ps1" "Fix login bug"

# 或在脚本目录下执行
.\commit.ps1 "Fix login bug"

# 使用默认提交信息（当前时间戳）
.\commit.ps1
```

**注意**: 如果在cmd命令行中，需要使用完整的PowerShell调用语法。

### 方法2：直接使用Python脚本

```bash
# 使用自定义提交信息
python auto_commit.py "添加新功能"

# 使用默认提交信息
python auto_commit.py
```

## 工作流程

1. **检查Git状态** - 确认是否有需要提交的更改
2. **拉取远程代码** - 获取最新的远程代码
3. **冲突检测** - 如果有冲突，提示用户手动解决
4. **添加更改** - 将所有更改添加到暂存区
5. **提交更改** - 使用提供的或默认的提交信息
6. **推送到远程** - 推送到远程仓库
7. **处理推送冲突** - 如果推送被拒绝，自动重新拉取并推送

## 错误处理

脚本包含完善的错误处理机制：

- **合并冲突** - 检测到冲突时会停止执行，提示用户手动解决
- **推送被拒绝** - 自动重新拉取最新代码并重试推送
- **网络问题** - 提供清晰的错误信息
- **权限问题** - 检测并提示相关错误

## 注意事项

⚠️ **使用前请确保：**
- 当前目录是一个Git仓库
- 已配置Git用户信息（user.name 和 user.email）
- 有远程仓库的推送权限
- Python 3.x 已安装

⚠️ **冲突处理：**
- 如果遇到合并冲突，脚本会停止执行
- 请手动解决冲突后重新运行脚本
- 不要在有未解决冲突的情况下强制运行

## 示例输出

```
🚀 开始自动Git提交流程...
==================================================
📝 提交信息: 修复登录bug
==================================================
📋 检查Git状态...
📝 发现以下更改:
 M  src/login.js
 A  docs/login-fix.md
🔄 拉取远程最新代码...
✅ 成功拉取最新代码
📦 添加所有更改到暂存区...
✅ 成功添加所有更改
💾 提交更改: 修复登录bug
✅ 成功提交更改
🚀 推送到远程仓库...
✅ 成功推送到远程仓库
==================================================
🎉 自动提交流程完成！
✅ 提交信息: 修复登录bug
✅ 已成功推送到远程仓库
```

## 自定义配置

如需修改默认行为，可以编辑 `auto_commit.py` 文件：

- 修改默认分支名（当前为 `master`）
- 调整提交信息格式
- 添加额外的检查步骤
- 自定义错误处理逻辑

## 故障排除

**问题：脚本无法执行**
- 检查Python是否正确安装
- 确认当前目录是Git仓库
- 检查文件权限

**问题：推送失败**
- 检查网络连接
- 确认远程仓库权限
- 检查分支名是否正确

**问题：编码问题**
- 脚本已设置UTF-8编码
- 如仍有问题，检查系统编码设置